<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Infers ethnicity using DNA methylation microarray data — pl_infer_ethnicity • planet</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Infers ethnicity using DNA methylation microarray data — pl_infer_ethnicity" />
<meta property="og:description" content="pl_infer_ethnicity Uses a glmnet model to predict ethnicity using DNA methylation data." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">planet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cell_composition.html">Infer Placental Cell Composition</a>
    </li>
    <li>
      <a href="../articles/ethnicity.html">Infer Ethnicity</a>
    </li>
    <li>
      <a href="../articles/gestational_age.html">Infer Gestational Age</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/wvictor14/planet/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Infers ethnicity using DNA methylation microarray data</h1>
    <small class="dont-index">Source: <a href='http://github.com/wvictor14/planet/blob/master/R/pl_infer_ethnicity.R'><code>R/pl_infer_ethnicity.R</code></a></small>
    <div class="hidden name"><code>pl_infer_ethnicity.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>pl_infer_ethnicity</code> Uses a glmnet model to predict ethnicity using DNA methylation data.</p>
    </div>

    <pre class="usage"><span class='fu'>pl_infer_ethnicity</span><span class='op'>(</span><span class='va'>betas</span>, threshold <span class='op'>=</span> <span class='fl'>0.75</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>betas</th>
      <td><p>n x m dataframe of methylation values on the beta scale (0, 1), where the variables
are arranged in rows, and samples in columns. Should contain all 1860 predictors and be
normalized with NOOB and BMIQ.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>A probability threshold ranging from (0, 1) to call samples 'ambiguous'.
Defaults to 0.75.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a [tibble][tibble::tibble-package]</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Predicts self-reported ethnicity from 3 classes: Africans, Asians, and Caucasians, using
placental DNA methylation data measured on the Infinium 450k/EPIC methylation array. Will return
membership probabilities that often reflect genetic ancestry composition.</p>
<p>The input data should contain all 1860 predictors (cpgs) of the final GLMNET model.</p>
<p>It's recommended to use the same normalization methods used on the training data: NOOB and BMIQ.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## To predict ethnicity on 450k/850k samples</span>

<span class='co'># Load placenta DNAm data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>pl_betas</span><span class='op'>)</span>
<span class='fu'>pl_infer_ethnicity</span><span class='op'>(</span><span class='va'>pl_betas</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "1860 of 1860 predictors present."</div><div class='output co'>#&gt; <span class='message'>Loading required package: Matrix</span></div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 24 x 7</span><span>
#&gt;    Sample_ID Predicted_ethni~ Predicted_ethni~ Prob_African Prob_Asian
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>            </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>                   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>      </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> GSM19449~ Caucasian        Caucasian            0.003</span><span style='text-decoration: underline;'>31</span><span>    0.016</span><span style='text-decoration: underline;'>4</span><span>  
#&gt; </span><span style='color: #555555;'> 2</span><span> GSM19449~ Caucasian        Caucasian            0.000</span><span style='text-decoration: underline;'>772</span><span>   0.000</span><span style='text-decoration: underline;'>514</span><span>
#&gt; </span><span style='color: #555555;'> 3</span><span> GSM19449~ Caucasian        Caucasian            0.000</span><span style='text-decoration: underline;'>806</span><span>   0.000</span><span style='text-decoration: underline;'>699</span><span>
#&gt; </span><span style='color: #555555;'> 4</span><span> GSM19449~ Caucasian        Caucasian            0.000</span><span style='text-decoration: underline;'>883</span><span>   0.000</span><span style='text-decoration: underline;'>792</span><span>
#&gt; </span><span style='color: #555555;'> 5</span><span> GSM19449~ Caucasian        Caucasian            0.000</span><span style='text-decoration: underline;'>885</span><span>   0.001</span><span style='text-decoration: underline;'>30</span><span> 
#&gt; </span><span style='color: #555555;'> 6</span><span> GSM19449~ Caucasian        Caucasian            0.000</span><span style='text-decoration: underline;'>852</span><span>   0.000</span><span style='text-decoration: underline;'>973</span><span>
#&gt; </span><span style='color: #555555;'> 7</span><span> GSM19449~ Caucasian        Caucasian            0.000</span><span style='text-decoration: underline;'>902</span><span>   0.001</span><span style='text-decoration: underline;'>76</span><span> 
#&gt; </span><span style='color: #555555;'> 8</span><span> GSM19449~ Caucasian        Caucasian            0.001</span><span style='text-decoration: underline;'>74</span><span>    0.002</span><span style='text-decoration: underline;'>23</span><span> 
#&gt; </span><span style='color: #555555;'> 9</span><span> GSM19449~ Caucasian        Caucasian            0.000</span><span style='text-decoration: underline;'>962</span><span>   0.002</span><span style='text-decoration: underline;'>31</span><span> 
#&gt; </span><span style='color: #555555;'>10</span><span> GSM19449~ Caucasian        Caucasian            0.002</span><span style='text-decoration: underline;'>87</span><span>    0.003</span><span style='text-decoration: underline;'>56</span><span> 
#&gt; </span><span style='color: #555555;'># ... with 14 more rows, and 2 more variables: Prob_Caucasian </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>,</span><span>
#&gt; </span><span style='color: #555555;'>#   Highest_Prob </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span></div><div class='input'>
</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Victor Yuan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


